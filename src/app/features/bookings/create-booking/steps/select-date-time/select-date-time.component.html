<div class="select-date-time-step">
  <!-- No Groomer Selected -->
  <div *ngIf="!selectedGroomer" class="info-state">
    <mat-icon class="info-icon">person</mat-icon>
    <p>Please select a groomer first</p>
    <small>You must select a groomer before choosing a date and time</small>
  </div>

  <!-- Date Time Selection -->
  <div *ngIf="selectedGroomer" class="datetime-content">
    <div class="content-header">
      <h3>Select Date & Time</h3>
      <div class="groomer-info">
        <mat-icon class="groomer-icon" inline>person</mat-icon>
        <span>Booking for: {{ selectedGroomer.first_name }} {{ selectedGroomer.last_name }}</span>
      </div>
    </div>

    <div class="datetime-grid">
      <!-- Calendar Section -->
      <div class="calendar-section">
        <h4>Choose a Date</h4>

        <div class="calendar">
          <!-- Calendar Header -->
          <div class="calendar-header">
            <button class="nav-btn" (click)="previousMonth()">‹</button>
            <span class="month-year">{{ getCurrentMonthYear() }}</span>
            <button class="nav-btn" (click)="nextMonth()">›</button>
          </div>

          <!-- Day Names -->
          <div class="day-names">
            <div *ngFor="let dayName of dayNames" class="day-name">
              {{ dayName }}
            </div>
          </div>

          <!-- Calendar Days -->
          <div class="calendar-days">
            <div
              *ngFor="let date of calendarDays"
              class="calendar-day"
              [class.empty]="!date"
              [class.past]="date && !isDateSelectable(date)"
              [class.today]="isToday(date)"
              [class.selected]="isDateSelected(date)"
              [class.selectable]="date && isDateSelectable(date)"
              (click)="selectDate(date)"
            >
              <span *ngIf="date">{{ date.getDate() }}</span>
            </div>
          </div>
        </div>

        <!-- Selected Date Display -->
        <div class="selected-date-display" *ngIf="selectedDate">
          <mat-icon class="calendar-icon" inline>calendar_today</mat-icon>
          <span class="date-text">{{ formatDateDisplay(selectedDate) }}</span>
        </div>
      </div>

      <!-- Time Slots Section -->
      <div class="timeslots-section">
        <h4>Choose a Time</h4>

        <div *ngIf="!selectedDate" class="no-date-message">
          <mat-icon class="clock-icon" inline>schedule</mat-icon>
          <p>Please select a date first</p>
        </div>

        <div *ngIf="selectedDate && isLoadingTimeSlots" class="loading-message">
          <mat-icon class="clock-icon" inline>schedule</mat-icon>
          <p>Loading time slots...</p>
        </div>

        <div *ngIf="selectedDate && !isLoadingTimeSlots && timeSlots.length === 0" class="no-slots-message">
          <mat-icon class="clock-icon" inline>schedule</mat-icon>
          <p>No time slots available</p>
        </div>

        <div *ngIf="selectedDate && !isLoadingTimeSlots && timeSlots.length > 0" class="timeslots-grid">
          <div
            *ngFor="let slot of timeSlots"
            class="timeslot-card"
            [class.selected]="selectedTimeSlot?.id === slot.id"
            [class.unavailable]="!slot.available"
            (click)="selectTimeSlot(slot)"
          >
            <mat-icon class="slot-icon" inline>schedule</mat-icon>
            <span class="slot-time">{{ slot.label }}</span>
            <span class="unavailable-badge" *ngIf="!slot.available">Booked</span>
            <div class="check-icon" *ngIf="selectedTimeSlot?.id === slot.id">✓</div>
          </div>
        </div>

        <!-- Selected Time Display -->
        <div class="selected-time-display" *ngIf="selectedTimeSlot">
          <mat-icon class="clock-icon" inline>schedule</mat-icon>
          <span class="time-text">{{ selectedTimeSlot?.label }}</span>
        </div>
      </div>
    </div>

    <!-- Summary -->
    <div class="datetime-summary" *ngIf="selectedDate && selectedTimeSlot">
      <mat-icon class="summary-icon">check_circle</mat-icon>
      <div class="summary-text">
        <div class="summary-title">Appointment Scheduled</div>
        <div class="summary-details">
          {{ formatDateDisplay(selectedDate) }} - {{ selectedTimeSlot?.label }}
        </div>
      </div>
    </div>

    <!-- Validation Message -->
    <div class="validation-message" *ngIf="selectedDate && !selectedTimeSlot">
      <mat-icon class="info-icon" inline>info</mat-icon>
      <span>Please select a time slot to continue</span>
    </div>
  </div>
</div>
